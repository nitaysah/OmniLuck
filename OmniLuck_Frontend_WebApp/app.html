<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* QR Code & Retailer Styles */
        .qr-container {
            display: none;
            /* Hidden by default */
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border: 2px dashed var(--accent-purple);
            border-radius: 16px;
        }

        .retailer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--deep-purple);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 220px;
            perspective: 1000px;
            cursor: pointer;
            margin-top: 0;
            margin-bottom: 10px;
            /* Gap 10px to Home Button */
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front,
        .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 20px;
            box-sizing: border-box;
        }

        .flip-card-back {
            transform: rotateY(180deg);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid var(--accent-purple);
            padding: 16px;
            display: flex;
            flex-direction: column;
        }

        /* Section Buttons */
        .section-button {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(128, 77, 179, 0.3);
            border-radius: 14px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--deep-purple);
            transition: all 0.2s ease;
            margin-bottom: 10px;
        }

        .section-button:hover {
            background: rgba(255, 255, 255, 0.85);
            border-color: var(--accent-purple);
            transform: translateY(-1px);
        }

        .section-button.power-hours {
            border-color: rgba(255, 200, 100, 0.6);
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-card {
            background: white;
            border-radius: 20px;
            max-width: 90%;
            max-height: 80vh;
            width: 400px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.25s ease;
            display: flex;
            flex-direction: column;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: rgba(128, 77, 179, 0.1);
            border-bottom: 1px solid rgba(128, 77, 179, 0.1);
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1rem;
            color: var(--deep-purple);
        }

        .modal-close-x {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--accent-purple);
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .modal-close-x:hover {
            opacity: 1;
        }

        .modal-content {
            padding: 20px;
            max-height: 50vh;
            overflow-y: auto;
            color: var(--deep-purple);
            line-height: 1.6;
            flex: 1;
        }

        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid rgba(128, 77, 179, 0.1);
        }

        .modal-close-btn {
            width: 100%;
            padding: 14px;
            background: var(--accent-purple);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .modal-close-btn:hover {
            background: var(--deep-purple);
        }

        .modal-close-btn.gold {
            background: var(--accent-gold);
            color: var(--deep-purple);
        }

        /* Premium Gold Accent for Personal QR */
        .personal-qr-container {
            border: 4px solid #FFD700 !important;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.5) !important;
            background: linear-gradient(135deg, #fff 0%, #fffdf0 100%) !important;
            transform: scale(1.02);
            transition: all 0.3s ease;
        }

        .personal-qr-container #qr-code-label {
            color: #B8860B !important;
            font-weight: 800 !important;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }
    </style>
    <title>Discover Your Luck - OmniLuck</title>
    <meta name="description"
        content="Discover your daily luck percentage powered by celestial alignment and numerology">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;900&display=swap"
        rel="stylesheet">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ú®</text></svg>">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <!-- Spinning Galaxy Background -->
    <!-- Spinning Colliding Galaxies Background -->
    <div class="galaxy-container">
        <div class="galaxy-wrapper">
            <!-- Milky Way -->
            <div class="galaxy milky-way">
                <div class="galaxy-core"></div>
                <div class="arm"></div>
                <div class="arm"></div>
                <div class="arm"></div>
            </div>

            <!-- Andromeda -->
            <div class="galaxy andromeda">
                <div class="galaxy-core"></div>
                <div class="arm"></div>
                <div class="arm"></div>
                <div class="arm"></div>
            </div>

            <div class="stars"></div>
        </div>
    </div>

    <div class="app-container">
        <!-- User Menu (Floating Top Right for all views) -->
        <div class="user-menu-container" id="user-menu-container" style="display: none;">
            <button id="user-menu-btn" class="user-menu-btn">
                <span id="user-greeting">Hi, User</span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
            <div id="user-dropdown" class="user-menu-dropdown">
                <div id="menu-about-btn" class="menu-item">‚ÑπÔ∏è About Us</div>
                <div id="menu-contact-btn" class="menu-item">üìß Contact Us</div>
                <div id="menu-settings-btn" class="menu-item">‚öôÔ∏è Settings</div>
                <div id="menu-logout-btn" class="menu-item" style="color: #d32f2f;">üö™ Logout</div>
            </div>
        </div>

        <!-- Dashboard View (Logged In Landing) -->
        <div id="dashboard-view" class="view">
            <header style="margin-top: 40px; margin-bottom: 15px;">
                <!-- Welcome Text Stack (No Icon) -->
                <div style="display: flex; flex-direction: column; align-items: center; gap: 0px;">
                    <span style="font-size: 1.5rem; font-weight: 700; color: var(--deep-purple);">Welcome back,</span>
                    <span id="dashboard-user-name"
                        style="font-size: 2.8rem; font-weight: 800; color: #D8CCFF; text-shadow: 0 2px 8px rgba(255,255,255,0.8); line-height: 1.1;">User</span>
                </div>
                <p style="opacity: 0.6; font-size: 0.9rem; margin-top: 6px; color: var(--deep-purple);">The cosmos
                    awaits your query.</p>
            </header>

            <div class="card"
                style="background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.6); padding: 30px 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.05);">
                <div style="text-align: center;">
                    <div style="text-align: left; margin-bottom: 24px; color: var(--deep-purple);">
                        <p
                            style="font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7; margin-bottom: 12px; text-align: center;">
                            Your Cosmic Profile</p>

                        <div
                            style="display: flex; flex-direction: column; gap: 16px; padding: 0 10px; text-align: left;">
                            <!-- Name -->
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span
                                    style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; font-weight: 700;">My
                                    Full Name:</span>
                                <span id="dashboard-name-display"
                                    style="font-weight: 800; font-size: 1.5rem; color: var(--deep-purple); line-height: 1.2;">--</span>
                            </div>

                            <!-- Zodiac -->
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span
                                    style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; font-weight: 700;">My
                                    Zodiac Sign:</span>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 1.5rem;" id="dashboard-zodiac-icon">‚ú®</span>
                                    <span id="dashboard-zodiac-name"
                                        style="font-weight: 800; font-size: 1.5rem; color: var(--deep-purple);">--</span>
                                </div>
                            </div>

                            <!-- Date of Birth -->
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span
                                    style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; font-weight: 700;">My
                                    Date of Birth:</span>
                                <span id="dashboard-dob-display"
                                    style="font-weight: 800; font-size: 1.5rem; color: var(--deep-purple);">--</span>
                            </div>

                            <!-- Place -->
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span
                                    style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; font-weight: 700;">My
                                    Place of Birth:</span>
                                <span id="dashboard-place-display"
                                    style="font-weight: 800; font-size: 1.5rem; color: var(--deep-purple);">--</span>
                            </div>

                            <!-- Time -->
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span
                                    style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.6; font-weight: 700;">My
                                    Time of Birth:</span>
                                <span id="dashboard-time-display"
                                    style="font-weight: 800; font-size: 1.5rem; color: var(--deep-purple);">--</span>
                            </div>
                        </div>
                    </div>

                    <button id="dashboard-reveal-btn" class="primary-btn"
                        style="box-shadow: 0 10px 25px rgba(124, 77, 255, 0.3); width: 100%; margin-bottom: 16px;">
                        <span class="btn-text">Forecast my Luck</span>
                        <div class="wand-loading-container">
                            <span class="magic-trail trail-1">‚ú®</span>
                            <span class="magic-trail trail-2">‚ú®</span>
                            <span class="magic-wand-icon">ü™Ñ</span>
                            <span class="magic-trail trail-3">‚ú®</span>
                        </div>
                        <span class="btn-icon">ü™Ñ</span>
                    </button>

                    <button id="dashboard-logout-main-btn" class="secondary-btn"
                        style="width: 100%; background: rgba(255,255,255,0.4); border: 1px solid rgba(255,255,255,0.5);">
                        <span>üö™</span> Logout
                    </button>
                </div>
            </div>
        </div>

        <!-- Input View -->
        <div id="input-view" class="view input-view">
            <div style="position: absolute; top: 15px; left: 15px; z-index: 10;">
                <button id="guest-home-btn"
                    style="background: white; border: 1px solid rgba(128, 77, 179, 0.3); border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; color: var(--deep-purple); cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: all 0.2s ease;">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </button>
            </div>

            <div class="header-section" style="text-align: center; padding-top: 15px; margin-bottom: 12px;">
                <h1 style="font-size: 1.8rem; font-weight: 800; color: var(--deep-purple); margin-bottom: 6px;">Discover
                    Your Luck</h1>
                <p style="font-size: 0.9rem; color: var(--deep-purple-lighter); margin: 0;">A Fusion of Astrology,
                    Physics & Predictive AI</p>
            </div>

            <div class="card">
                <div class="input-group">
                    <label for="name">
                        <span class="label-icon">üë§</span> YOUR NAME <span style="color: #ff4444;">*</span>
                    </label>
                    <input type="text" id="name" placeholder="Enter your name">
                </div>

                <div class="input-group">
                    <label for="dob">
                        <span class="label-icon">üìÖ</span> DATE OF BIRTH <span style="color: #ff4444;">*</span>
                    </label>
                    <input type="date" id="dob">
                </div>



                <div class="input-group">
                    <label for="birth-place">
                        <span class="label-icon">üìç</span> PLACE OF BIRTH <span style="color: #ff4444;">*</span>
                    </label>
                    <input type="text" id="birth-place" placeholder="City, Country (e.g. Dallas, USA)">
                </div>

                <div class="input-group">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <label for="birth-time" style="margin-bottom: 0;">
                            <span class="label-icon">‚è∞</span> TIME OF BIRTH <span style="color: #ff4444;">*</span>
                        </label>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button id="tob-info-btn" type="button" class="info-circle">i</button>
                        </div>
                    </div>

                    <!-- Don't Know Checkbox -->
                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;">
                        <input type="checkbox" id="tob-na-checkbox" style="width: auto; margin: 0;">
                        <label for="tob-na-checkbox"
                            style="font-size: 0.85rem; color: var(--deep-purple); margin: 0; cursor: pointer;">Don't
                            know</label>
                    </div>

                    <!-- Time & Timezone Container -->
                    <div id="time-inputs-container">
                        <div style="position: relative; margin-bottom: 12px;">
                            <input type="time" id="birth-time" style="width: 100%;">
                        </div>
                    </div>

                    <!-- N/A Message (Hidden by default) -->
                    <div id="tob-na-message"
                        style="display: none; font-size: 0.75rem; color: var(--deep-purple); opacity: 0.8; font-style: italic; margin-top: 4px;">
                        Midday Alignment Active: Following the Astrology standard for unknown birth times, your
                        chart is
                        anchored to 12:00 PM to maximize planetary accuracy and ensure a reliable luck forecast.
                    </div>

                    <div id="tob-explainer" class="explainer-text" style="display: none;">
                        Add your exact local time of birth for full precision. This data acts as your cosmic GPS,
                        identifying the precise degrees of your Rising Sign and the 12 Life Houses that shift every
                        few
                        minutes. These details are vital for accurate daily insights and a truly personalized Luck
                        Score. If unknown, we apply the 12:00 PM Astrology standard to maximize planetary accuracy
                        and
                        provide reliable guidance.
                    </div>
                </div>

                <!-- Personal Context Section -->


                <!-- Personal Context Section -->
            </div>

            <button id="reveal-btn" class="primary-btn">
                <span class="btn-text">Forecast my Luck</span>
                <div class="wand-loading-container">
                    <span class="magic-trail trail-1">‚ú®</span>
                    <span class="magic-trail trail-2">‚ú®</span>
                    <span class="magic-wand-icon">ü™Ñ</span>
                    <span class="magic-trail trail-3">‚ú®</span>
                </div>
                <span class="btn-icon">ü™Ñ</span>
            </button>

            <button id="logout-main-btn" class="secondary-btn" style="margin-top: 16px;">
                <span>üö™</span> Logout
            </button>

        </div>
        <!-- Result View -->
        <div id="result-view" class="view">
            <div class="result-content">

                <!-- Daily Luck Score Card (Collapsible, Expanded by Default) -->
                <div class="card" id="luck-score-card" style="cursor: pointer; margin-top: 20px;"
                    onclick="toggleLuckCard()">
                    <div id="luck-card-header"
                        style="display: flex; justify-content: space-between; align-items: center;">
                        <span id="luck-card-title" style="font-weight: 700; color: var(--deep-purple);">üéØ Daily
                            Luck Score</span>
                        <span id="luck-card-arrow"
                            style="color: var(--accent-purple); font-size: 1.2rem; transition: transform 0.3s;">‚ñº</span>
                    </div>

                    <div id="luck-card-content" style="display: block;">
                        <div class="luck-circle" style="margin: 20px auto;">
                            <svg class="progress-ring" viewBox="0 0 200 200">
                                <circle class="progress-ring-bg" cx="100" cy="100" r="90" />
                                <circle class="progress-ring-fill" cx="100" cy="100" r="90" />
                            </svg>
                            <div class="luck-value">
                                <span id="result-percentage">0</span>
                                <span class="percent-sign">%</span>
                            </div>
                        </div>

                        <!-- Caption (Inside Card) -->
                        <div id="result-caption" class="result-caption"
                            style="text-align: center; margin: 12px 0 0 0; font-size: 1rem; font-weight: 600; color: var(--accent-purple);">
                        </div>
                    </div>
                </div>

                <!-- SECTION 1: Daily Luck Analysis Button -->
                <button class="section-button" onclick="openModal('analysis')">
                    <span>üìú Read Daily Luck Analysis</span>
                    <span style="color: var(--accent-purple);">‚Üí</span>
                </button>

                <!-- SECTION 2: Cosmic Strategy Button -->
                <button id="strategy-btn" class="section-button" onclick="openModal('strategy')" style="display: none;">
                    <span>üß≠ Read Cosmic Strategy</span>
                    <span style="color: var(--accent-purple);">‚Üí</span>
                </button>

                <!-- SECTION 3: Power Hours Button -->
                <button id="power-hours-btn" class="section-button power-hours" onclick="openModal('power-hours')"
                    style="display: none;">
                    <span>‚è∞ View Power Hours</span>
                    <span style="color: var(--accent-gold);">‚Üí</span>
                </button>

                <!-- MODAL: Daily Luck Analysis -->
                <div id="analysis-modal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'analysis')">
                    <div class="modal-card" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>üìú Daily Luck Analysis</h3>
                            <button class="modal-close-x" onclick="closeModal('analysis')">√ó</button>
                        </div>
                        <div class="modal-content">
                            <p id="fortune-text" style="margin-bottom: 16px;"></p>
                            <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                                <button id="listen-btn" class="secondary-btn"
                                    style="padding: 8px 16px; font-size: 0.9rem;">
                                    <span>üîä</span> Listen
                                </button>
                                <button id="stop-btn" class="secondary-btn"
                                    style="padding: 8px 16px; font-size: 0.9rem; display: none;">
                                    <span>‚èπÔ∏è</span> Stop
                                </button>
                            </div>
                            <div id="factors-box" class="factors-box" style="display: none; margin-bottom: 16px;">
                                <span class="factors-label">Aggregation of below scores:</span>
                                <p id="factors-text"></p>
                            </div>
                            <div id="traits-list" class="traits-list"></div>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close-btn" onclick="closeModal('analysis')">Close</button>
                        </div>
                    </div>
                </div>

                <!-- MODAL: Cosmic Strategy -->
                <div id="strategy-modal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'strategy')">
                    <div class="modal-card" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>üß≠ Cosmic Strategy</h3>
                            <button class="modal-close-x" onclick="closeModal('strategy')">√ó</button>
                        </div>
                        <div class="modal-content">
                            <p id="strategy-text" style="font-style: italic;"></p>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close-btn" onclick="closeModal('strategy')">Close</button>
                        </div>
                    </div>
                </div>

                <!-- MODAL: Power Hours -->
                <div id="power-hours-modal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'power-hours')">
                    <div class="modal-card" onclick="event.stopPropagation()">
                        <div class="modal-header" style="background: rgba(255, 200, 100, 0.2);">
                            <h3>‚è∞ Power Hours</h3>
                            <button class="modal-close-x" style="color: var(--accent-gold);"
                                onclick="closeModal('power-hours')">√ó</button>
                        </div>
                        <div class="modal-content">
                            <div id="time-slots-list" style="display: flex; flex-direction: column; gap: 12px;"></div>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close-btn gold" onclick="closeModal('power-hours')">Close</button>
                        </div>
                    </div>
                </div>


                <!-- Daily Astro Insights Button -->
                <button id="kundali-btn" class="section-button" onclick="openModal('astro-insights')">
                    <span>üåü Read Daily Astro Insights</span>
                    <span style="color: var(--accent-purple);">‚Üí</span>
                </button>

                <!-- MODAL: Daily Astro Insights -->
                <div id="astro-insights-modal" class="modal-overlay"
                    onclick="closeModalOnOverlay(event, 'astro-insights')">
                    <div class="modal-card" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>üåü Daily Astro Insights</h3>
                            <button class="modal-close-x" onclick="closeModal('astro-insights')">√ó</button>
                        </div>
                        <div class="modal-content" id="kundali-report-content">
                            <p>Loading insights...</p>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close-btn" onclick="closeModal('astro-insights')">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Lucky Powerball Numbers Button -->
                <button id="powerball-btn" class="section-button" onclick="openModal('powerball')"
                    style="display: none;">
                    <span>üé± Lucky Powerball Numbers</span>
                    <span style="color: var(--accent-purple);">‚Üí</span>
                </button>

                <!-- MODAL: Lucky Powerball Numbers -->
                <div id="powerball-modal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'powerball')">
                    <div class="modal-card" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>üé± Lucky Powerball Numbers</h3>
                            <button class="modal-close-x" onclick="closeModal('powerball')">√ó</button>
                        </div>
                        <div class="modal-content" id="powerball-content">
                            <!-- Personal Powerball -->
                            <div id="personal-powerball-section" style="margin-bottom: 24px;">
                                <h4
                                    style="color: var(--accent-gold); margin: 0 0 12px 0; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
                                    üåü Your Personal Lucky Numbers</h4>
                                <div id="personal-powerball-display"
                                    style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; margin-bottom: 8px;">
                                    <!-- White balls and powerball will be rendered here -->
                                </div>
                                Based on your birth chart - these numbers stay with you</p>
                            </div>

                            <!-- Daily Powerballs -->
                            <div id="daily-powerballs-section">
                                <div
                                    style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 12px; border-bottom: 1px solid rgba(0,0,0,0.05); padding-bottom: 12px;">
                                    <h4
                                        style="color: var(--accent-purple); margin: 0; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
                                        üìÖ Today's Cosmic Combinations
                                    </h4>
                                    <!-- Dynamic Potency Timer -->
                                    <div id="cosmic-expiry-container"
                                        style="font-size: 0.75rem; color: #dc2626; font-weight: 600; margin-bottom: 8px; display: flex; align-items: center; gap: 4px;">
                                        <span>‚è≥ Cosmic Alignment Expiry:</span>
                                        <span id="cosmic-countdown">--:--:--</span>
                                    </div>
                                    <div style="display: flex; gap: 8px; align-items: center;">
                                        <span style="font-size: 0.8rem; color: #666;">Lines:</span>
                                        <input type="number" id="pb-lines-input" value="5" min="1" max="50"
                                            placeholder="Max 50"
                                            style="width: 50px; padding: 6px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; text-align: center;">
                                        <button id="pb-generate-btn"
                                            style="background: var(--deep-purple); color: white; border: none; padding: 6px 16px; border-radius: 8px; font-size: 0.8rem; cursor: pointer; flex: 1; font-weight: 500; font-family: inherit;">Generate
                                            Request</button>
                                    </div>
                                </div>
                                <div id="daily-powerballs-list">
                                    <!-- Daily combinations will be rendered here -->
                                </div>
                            </div>

                            <!-- Retailer Bridge Section -->
                            <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #eee;">
                                <h4
                                    style="color: var(--deep-purple); margin: 0 0 16px 0; font-size: 0.9rem; text-transform: uppercase;">
                                    üè¨ Retailer Bridge
                                </h4>

                                <!-- Scan & Pay Logic -->
                                <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-size: 0.85rem; font-weight: 500;">Verify Age (18+)</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="age-verify-toggle">
                                            <span class="slider"></span>
                                        </label>
                                    </div>

                                    <div style="display: flex; gap: 8px;">
                                        <button id="scan-pay-btn"
                                            style="flex: 1; background: var(--accent-gold); color: white; border: none; padding: 12px; border-radius: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; opacity: 0.5; pointer-events: none; transition: all 0.3s;">
                                            <span style="font-size: 1.1rem;">üì±</span> Scan Personal
                                        </button>
                                        <button id="scan-all-daily-btn"
                                            style="flex: 1; background: var(--deep-purple); color: white; border: none; padding: 12px; border-radius: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; opacity: 0.5; pointer-events: none; transition: all 0.3s;">
                                            <span style="font-size: 1.1rem;">üéüÔ∏è</span> Scan Daily
                                        </button>
                                    </div>
                                </div>

                                <!-- QR Container -->
                                <div id="pb-qr-container" class="qr-container">
                                    <h5 style="margin: 0 0 12px 0; color: var(--deep-purple);">Your Digital Play Slip
                                    </h5>
                                    <div id="qr-code-label"
                                        style="font-size: 0.8rem; font-weight: 600; color: var(--accent-purple); margin-bottom: 8px;">
                                        Personal Numbers</div>
                                    <div id="pb-qr-code" style="margin-bottom: 12px;"></div>
                                    <p
                                        style="font-size: 0.75rem; color: #666; text-align: center; margin-bottom: 12px;">
                                        Scan at authorized lottery terminal.<br>
                                        Seed: <span id="qr-seed-hash"
                                            style="font-family: monospace; color: var(--accent-purple);"></span>
                                    </p>
                                    <button id="save-qr-btn"
                                        style="background: transparent; border: 1px solid #ddd; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 0.8rem;">
                                        üíæ Save to Gallery
                                    </button>
                                </div>

                                <!-- Retailer Locator -->
                                <div style="margin-top: 24px;">
                                    <h5 style="color: var(--deep-purple); margin: 0 0 12px 0;">üìç Nearby Retailers</h5>

                                    <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                                        <input type="text" id="retailer-zip" placeholder="Zip Code"
                                            style="width: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 12px; font-family: inherit; text-align: center; font-size: 1rem;">
                                        <button id="find-retailers-btn"
                                            style="flex: 1; background: white; border: 1px solid var(--deep-purple); color: var(--deep-purple); padding: 10px; border-radius: 12px; font-weight: 600; cursor: pointer;">
                                            Search Nearby Stores
                                        </button>
                                    </div>

                                    <div id="retailer-list"
                                        style="background: #f9f9f9; border-radius: 12px; overflow: hidden; min-height: 0;">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close-btn" onclick="closeModal('powerball')">Close</button>
                        </div>
                    </div>
                </div>


                <!-- 7-Day Forecast FLIP Card -->
                <div id="forecast-flip-card" class="flip-card" style="display: none;">
                    <div class="flip-card-inner" id="forecast-flip-inner">

                        <!-- FRONT SIDE - Teaser -->
                        <div class="flip-card-front"
                            style="display: flex; flex-direction: column; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(192, 153, 240, 0.25)); border: 1px solid var(--accent-purple);">
                            <span style="font-size: 3rem; margin-bottom: 12px;">üîÆ</span>
                            <h3 style="color: var(--deep-purple); font-weight: 700; margin: 0;">7-Day Cosmic
                                Forecast
                            </h3>
                            <p style="color: var(--deep-purple); opacity: 0.7; margin: 8px 0 0 0;">Tap to reveal
                                your
                                luck trajectory</p>
                            <div
                                style="display: flex; align-items: center; gap: 8px; margin-top: 16px; color: var(--accent-purple);">
                                <span style="font-size: 1.2rem;">üëÜ</span>
                                <span style="font-size: 0.85rem; font-weight: 600;">Click to flip</span>
                            </div>
                        </div>

                        <!-- BACK SIDE - Full Chart -->
                        <div class="flip-card-back">

                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 1.3rem;">üìÖ</span>
                                    <h3 style="margin: 0; font-size: 1rem; color: var(--deep-purple);">7-Day Luck
                                        Trajectory</h3>
                                </div>
                                <span style="font-size: 1.1rem; opacity: 0.5;">‚Ü©Ô∏è</span>
                            </div>

                            <div
                                style="display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.8rem; padding: 0 4px;">
                                <span style="color: var(--deep-purple);">Trend: <strong id="forecast-trend"
                                        style="color: var(--accent-purple);">--</strong></span>
                                <span style="color: var(--deep-purple);">Peak: <strong id="forecast-best"
                                        style="color: var(--accent-purple);">--</strong></span>
                            </div>

                            <div id="forecast-list"
                                style="display: flex; gap: 4px; flex: 1; width: 100%; align-items: flex-end;">
                                <!-- JS Injected Items -->
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Info Modal -->
                <div id="info-modal" class="modal" style="display: none;">
                    <div class="modal-content card" style="text-align: center;">
                        <span class="close-modal" id="close-info-modal">&times;</span>
                        <h3 id="info-modal-title" style="color: var(--deep-purple); margin-bottom: 15px;">--</h3>
                        <p id="info-modal-text" style="color: var(--deep-purple); opacity: 0.8;">--</p>
                    </div>
                </div>


            </div>

            <button id="try-again-btn" class="secondary-btn">
                <span>üè†</span> Home
            </button>
            <div
                style="margin-top: 30px; margin-bottom: 20px; text-align: center; font-size: 0.75rem; color: var(--deep-purple-lighter); opacity: 0.8;">
                <a href="privacy.html" style="text-decoration: none; color: inherit;">Privacy Policy</a>
            </div>
        </div>
    </div>

    <script>
        // Toggle Daily Luck Score Card
        function toggleLuckCard() {
            const card = document.getElementById('luck-score-card');
            const content = document.getElementById('luck-card-content');
            const arrow = document.getElementById('luck-card-arrow');

            if (content.style.display === 'none') {
                // Expanding
                content.style.display = 'block';
                arrow.style.transform = 'rotate(0deg)';
                arrow.textContent = '‚ñº';
                card.classList.remove('collapsed');
            } else {
                // Collapsing
                content.style.display = 'none';
                arrow.style.transform = 'rotate(-90deg)';
                arrow.textContent = '‚ñ∂';
                card.classList.add('collapsed');
            }
        }
    </script>

    <!-- Firebase Config -->
    <script type="module" src="firebase-config.js?v=5"></script>
    <!-- API Client -->
    <script type="module" src="api-client.js?v=5"></script>
    <!-- Main Logic -->
    <script type="module" src="script.js?v=11"></script>
</body>

</html>